<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>Zumo - Sonar lib: C:/Users/Kamil/Dropbox/EIT/3_Rok/Microprocessor Technology 2/ZUMO/sonar/sonar.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Zumo - Sonar lib
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('sonar_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">sonar.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;MKL46Z4.h&quot;</code><br />
</div>
<p><a href="sonar_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a403b072b6fdfe59a42fcd7e26e32a4f3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sonar_8h.html#a403b072b6fdfe59a42fcd7e26e32a4f3">SONAR_INTERUPT_PRIORITY</a>&#160;&#160;&#160;3</td></tr>
<tr class="memdesc:a403b072b6fdfe59a42fcd7e26e32a4f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Define sonar IRQ priority.  <a href="#a403b072b6fdfe59a42fcd7e26e32a4f3">More...</a><br /></td></tr>
<tr class="separator:a403b072b6fdfe59a42fcd7e26e32a4f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5e988fb642c42b7fdb79aa5e0be30a0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sonar_8h.html#ae5e988fb642c42b7fdb79aa5e0be30a0">SONAR_MEAS_INTERVAL_MS</a>&#160;&#160;&#160;50</td></tr>
<tr class="memdesc:ae5e988fb642c42b7fdb79aa5e0be30a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Define sonar measurment interval. Triggers are send every <a class="el" href="sonar_8h.html#ae5e988fb642c42b7fdb79aa5e0be30a0" title="Define sonar measurment interval. Triggers are send every SONAR_MEAS_INTERVAL_MS by TPM1...">SONAR_MEAS_INTERVAL_MS</a> by TPM1. Setting lower value will increese measurmend speed but it will also make sonar more prone to residiual echo from previous measurments.  <a href="#ae5e988fb642c42b7fdb79aa5e0be30a0">More...</a><br /></td></tr>
<tr class="separator:ae5e988fb642c42b7fdb79aa5e0be30a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accc26a2e71d62cabac5599480b217444"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sonar_8h.html#accc26a2e71d62cabac5599480b217444">SONAR_MAX_RANGE_CM</a>&#160;&#160;&#160;300</td></tr>
<tr class="memdesc:accc26a2e71d62cabac5599480b217444"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines maximum wanted range of a sonar All measurments which return value greather than this, will be changed into 0. It is useful when we want to limit background noise picked up by a sonar.  <a href="#accc26a2e71d62cabac5599480b217444">More...</a><br /></td></tr>
<tr class="separator:accc26a2e71d62cabac5599480b217444"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5affd3b36be20953cbe5514ecb1d23a9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sonar_8h.html#a5affd3b36be20953cbe5514ecb1d23a9">SONAR_AVG_MODE</a>&#160;&#160;&#160;0</td></tr>
<tr class="memdesc:a5affd3b36be20953cbe5514ecb1d23a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable or disable averaging. When enabled echo measurment will actually result in average of <a class="el" href="sonar_8h.html#a654a02dec6f794c16f31690b6ef7ec7b" title="Define number of measurment to average. When SONAR_AVG_MODE is enabled measurment will actually resul...">SONAR_AVG_NUMBER</a> measurments 0 - off 1 - on.  <a href="#a5affd3b36be20953cbe5514ecb1d23a9">More...</a><br /></td></tr>
<tr class="separator:a5affd3b36be20953cbe5514ecb1d23a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a654a02dec6f794c16f31690b6ef7ec7b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sonar_8h.html#a654a02dec6f794c16f31690b6ef7ec7b">SONAR_AVG_NUMBER</a>&#160;&#160;&#160;5</td></tr>
<tr class="memdesc:a654a02dec6f794c16f31690b6ef7ec7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Define number of measurment to average. When <a class="el" href="sonar_8h.html#a5affd3b36be20953cbe5514ecb1d23a9" title="Enable or disable averaging. When enabled echo measurment will actually result in average of SONAR_AV...">SONAR_AVG_MODE</a> is enabled measurment will actually result in average of <a class="el" href="sonar_8h.html#a654a02dec6f794c16f31690b6ef7ec7b" title="Define number of measurment to average. When SONAR_AVG_MODE is enabled measurment will actually resul...">SONAR_AVG_NUMBER</a> measurments.  <a href="#a654a02dec6f794c16f31690b6ef7ec7b">More...</a><br /></td></tr>
<tr class="separator:a654a02dec6f794c16f31690b6ef7ec7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a693dc1e4acb94a17457de163dba95281"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sonar_8h.html#a693dc1e4acb94a17457de163dba95281">SonarFSM</a> { <br />
&#160;&#160;<a class="el" href="sonar_8h.html#a693dc1e4acb94a17457de163dba95281a07e3cb491c24cc1bbb160a962a4cfc59">SONAR_IDLE</a>, 
<a class="el" href="sonar_8h.html#a693dc1e4acb94a17457de163dba95281a366fc733846a7631747e8c599e208341">SONAR_TRIGGER_SENT</a>, 
<a class="el" href="sonar_8h.html#a693dc1e4acb94a17457de163dba95281a12f81920c5198203868e8b5d5db7c9f5">SONAR_CAPTURE_START</a>, 
<a class="el" href="sonar_8h.html#a693dc1e4acb94a17457de163dba95281a4d3cab2f3e524a90ca10ca11d231a9cd">SONAR_CAPTURE_END</a>, 
<br />
&#160;&#160;<a class="el" href="sonar_8h.html#a693dc1e4acb94a17457de163dba95281aee5ba9bab305ea8048e7d1849c9863ff">SONAR_CAPTURE_OVERFLOW</a>
<br />
 }</td></tr>
<tr class="memdesc:a693dc1e4acb94a17457de163dba95281"><td class="mdescLeft">&#160;</td><td class="mdescRight">Define Sonar FSM states.  <a href="sonar_8h.html#a693dc1e4acb94a17457de163dba95281">More...</a><br /></td></tr>
<tr class="separator:a693dc1e4acb94a17457de163dba95281"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbd34a926249020be7c9d3174b11c561"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sonar_8h.html#adbd34a926249020be7c9d3174b11c561">SonarWorkModes</a> { <a class="el" href="sonar_8h.html#adbd34a926249020be7c9d3174b11c561a9191b0f571007d73a6fc0f6a39d2b866">CONTINUOUS</a>, 
<a class="el" href="sonar_8h.html#adbd34a926249020be7c9d3174b11c561a3388f7110f6f25a54e215eb75d5d7516">SINGLE</a>
 }</td></tr>
<tr class="memdesc:adbd34a926249020be7c9d3174b11c561"><td class="mdescLeft">&#160;</td><td class="mdescRight">Define Sonar work modes.  <a href="sonar_8h.html#adbd34a926249020be7c9d3174b11c561">More...</a><br /></td></tr>
<tr class="separator:adbd34a926249020be7c9d3174b11c561"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa61bbb41b3a83a67b09bd239677cf96c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sonar_8h.html#aa61bbb41b3a83a67b09bd239677cf96c">Sonar_init</a> (<a class="el" href="sonar_8h.html#adbd34a926249020be7c9d3174b11c561">SonarWorkModes</a> InitialWorkMode)</td></tr>
<tr class="memdesc:aa61bbb41b3a83a67b09bd239677cf96c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize Sonar and required peripherials.  <a href="#aa61bbb41b3a83a67b09bd239677cf96c">More...</a><br /></td></tr>
<tr class="separator:aa61bbb41b3a83a67b09bd239677cf96c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e1a0ad5e1194e9983d26c84c1f2c634"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sonar_8h.html#a1e1a0ad5e1194e9983d26c84c1f2c634">SonarDistHandler</a> (uint16_t distance)</td></tr>
<tr class="memdesc:a1e1a0ad5e1194e9983d26c84c1f2c634"><td class="mdescLeft">&#160;</td><td class="mdescRight">User handler for sonar measurment results This function handles results from sonar's continuous measurments. It is also called when user triggered single measurment finishes. User can specify here what to do with the results. If sonar is used, user can obtain the angle at which the measurment was taken by reading global variable <a class="el" href="servo_8h.html#a6ca30760f53d2a937b251cfb0e76a6e0" title="Define Servo Position in degrees. This variable contains predicted position of a servo. ">ServoPosition</a>.  <a href="#a1e1a0ad5e1194e9983d26c84c1f2c634">More...</a><br /></td></tr>
<tr class="separator:a1e1a0ad5e1194e9983d26c84c1f2c634"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd69db8cc01c44c40690a6b6cc795860"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sonar_8h.html#abd69db8cc01c44c40690a6b6cc795860">SonarStartMeas</a> (void)</td></tr>
<tr class="memdesc:abd69db8cc01c44c40690a6b6cc795860"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize a single sonar measurment This function can be used to trigger a single measurment. Interupt will trigger <a class="el" href="sonar_8c.html#a86eef6da455b037173b71729addbbabc" title="User handler for sonar measurment results This function handles results from sonar&#39;s continuous measu...">SonarDistHandler</a>.  <a href="#abd69db8cc01c44c40690a6b6cc795860">More...</a><br /></td></tr>
<tr class="separator:abd69db8cc01c44c40690a6b6cc795860"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab806322900d6f7aee955e198bf4893c8"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sonar_8h.html#ab806322900d6f7aee955e198bf4893c8">SonarGetDistance</a> (void)</td></tr>
<tr class="memdesc:ab806322900d6f7aee955e198bf4893c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize a single sonar measurment and return distance in cm. This function can be used to trigger a single measurment.  <a href="#ab806322900d6f7aee955e198bf4893c8">More...</a><br /></td></tr>
<tr class="separator:ab806322900d6f7aee955e198bf4893c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a39581d0ec8dddb42a2cb1df283d3de42"><td class="memItemLeft" align="right" valign="top"><a class="el" href="sonar_8h.html#adbd34a926249020be7c9d3174b11c561">SonarWorkModes</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sonar_8h.html#a39581d0ec8dddb42a2cb1df283d3de42">SonarMode</a></td></tr>
<tr class="memdesc:a39581d0ec8dddb42a2cb1df283d3de42"><td class="mdescLeft">&#160;</td><td class="mdescRight">Define sonar work mode.  <a href="#a39581d0ec8dddb42a2cb1df283d3de42">More...</a><br /></td></tr>
<tr class="separator:a39581d0ec8dddb42a2cb1df283d3de42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6faa66e593ade7813b3e52d512b10cf4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="sonar_8h.html#a693dc1e4acb94a17457de163dba95281">SonarFSM</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sonar_8h.html#a6faa66e593ade7813b3e52d512b10cf4">SonarState</a></td></tr>
<tr class="memdesc:a6faa66e593ade7813b3e52d512b10cf4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines current sonar state.  <a href="#a6faa66e593ade7813b3e52d512b10cf4">More...</a><br /></td></tr>
<tr class="separator:a6faa66e593ade7813b3e52d512b10cf4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a5affd3b36be20953cbe5514ecb1d23a9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SONAR_AVG_MODE&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enable or disable averaging. When enabled echo measurment will actually result in average of <a class="el" href="sonar_8h.html#a654a02dec6f794c16f31690b6ef7ec7b" title="Define number of measurment to average. When SONAR_AVG_MODE is enabled measurment will actually resul...">SONAR_AVG_NUMBER</a> measurments 0 - off 1 - on. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000003">Todo:</a></b></dt><dd>Function not implemented yet </dd></dl>

</div>
</div>
<a class="anchor" id="a654a02dec6f794c16f31690b6ef7ec7b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SONAR_AVG_NUMBER&#160;&#160;&#160;5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Define number of measurment to average. When <a class="el" href="sonar_8h.html#a5affd3b36be20953cbe5514ecb1d23a9" title="Enable or disable averaging. When enabled echo measurment will actually result in average of SONAR_AV...">SONAR_AVG_MODE</a> is enabled measurment will actually result in average of <a class="el" href="sonar_8h.html#a654a02dec6f794c16f31690b6ef7ec7b" title="Define number of measurment to average. When SONAR_AVG_MODE is enabled measurment will actually resul...">SONAR_AVG_NUMBER</a> measurments. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000004">Todo:</a></b></dt><dd>Function not implemented yet </dd></dl>

</div>
</div>
<a class="anchor" id="a403b072b6fdfe59a42fcd7e26e32a4f3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SONAR_INTERUPT_PRIORITY&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Define sonar IRQ priority. </p>

</div>
</div>
<a class="anchor" id="accc26a2e71d62cabac5599480b217444"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SONAR_MAX_RANGE_CM&#160;&#160;&#160;300</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Defines maximum wanted range of a sonar All measurments which return value greather than this, will be changed into 0. It is useful when we want to limit background noise picked up by a sonar. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000002">Todo:</a></b></dt><dd>Function not implemented yet </dd></dl>

</div>
</div>
<a class="anchor" id="ae5e988fb642c42b7fdb79aa5e0be30a0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SONAR_MEAS_INTERVAL_MS&#160;&#160;&#160;50</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Define sonar measurment interval. Triggers are send every <a class="el" href="sonar_8h.html#ae5e988fb642c42b7fdb79aa5e0be30a0" title="Define sonar measurment interval. Triggers are send every SONAR_MEAS_INTERVAL_MS by TPM1...">SONAR_MEAS_INTERVAL_MS</a> by TPM1. Setting lower value will increese measurmend speed but it will also make sonar more prone to residiual echo from previous measurments. </p>
<dl class="section warning"><dt>Warning</dt><dd>Setting this to less than 35ms may produce sensor unsuable due to overlaping echos. </dd></dl>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="a693dc1e4acb94a17457de163dba95281"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="sonar_8h.html#a693dc1e4acb94a17457de163dba95281">SonarFSM</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Define Sonar FSM states. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="a693dc1e4acb94a17457de163dba95281a07e3cb491c24cc1bbb160a962a4cfc59"></a>SONAR_IDLE&#160;</td><td class="fielddoc">
<p>Idle - waiting for a trigger. </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a693dc1e4acb94a17457de163dba95281a366fc733846a7631747e8c599e208341"></a>SONAR_TRIGGER_SENT&#160;</td><td class="fielddoc">
<p>A trigger was sent. Waiting for echo. </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a693dc1e4acb94a17457de163dba95281a12f81920c5198203868e8b5d5db7c9f5"></a>SONAR_CAPTURE_START&#160;</td><td class="fielddoc">
<p>Reciving echo and measuring its length </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a693dc1e4acb94a17457de163dba95281a4d3cab2f3e524a90ca10ca11d231a9cd"></a>SONAR_CAPTURE_END&#160;</td><td class="fielddoc">
<p>Capture complete </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a693dc1e4acb94a17457de163dba95281aee5ba9bab305ea8048e7d1849c9863ff"></a>SONAR_CAPTURE_OVERFLOW&#160;</td><td class="fielddoc">
<p>Echo length exceeded maximum value defined by <a class="el" href="sonar_8h.html#accc26a2e71d62cabac5599480b217444" title="Defines maximum wanted range of a sonar All measurments which return value greather than this...">SONAR_MAX_RANGE_CM</a> </p>
</td></tr>
</table>

</div>
</div>
<a class="anchor" id="adbd34a926249020be7c9d3174b11c561"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="sonar_8h.html#adbd34a926249020be7c9d3174b11c561">SonarWorkModes</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Define Sonar work modes. </p>
<p>Sonar can operate in two modes. <a class="el" href="sonar_8h.html#adbd34a926249020be7c9d3174b11c561a9191b0f571007d73a6fc0f6a39d2b866">CONTINUOUS</a> and <a class="el" href="sonar_8h.html#adbd34a926249020be7c9d3174b11c561a3388f7110f6f25a54e215eb75d5d7516">SINGLE</a>. In <a class="el" href="sonar_8h.html#adbd34a926249020be7c9d3174b11c561a9191b0f571007d73a6fc0f6a39d2b866">CONTINUOUS</a> mode Sonar triggers are generated periodicaly by TPM. In <a class="el" href="sonar_8h.html#adbd34a926249020be7c9d3174b11c561a3388f7110f6f25a54e215eb75d5d7516">SINGLE</a> mode, a trigger must be generated by a user </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="adbd34a926249020be7c9d3174b11c561a9191b0f571007d73a6fc0f6a39d2b866"></a>CONTINUOUS&#160;</td><td class="fielddoc">
<p>Repeat measurment every <a class="el" href="sonar_8h.html#ae5e988fb642c42b7fdb79aa5e0be30a0" title="Define sonar measurment interval. Triggers are send every SONAR_MEAS_INTERVAL_MS by TPM1...">SONAR_MEAS_INTERVAL_MS</a> </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="adbd34a926249020be7c9d3174b11c561a3388f7110f6f25a54e215eb75d5d7516"></a>SINGLE&#160;</td><td class="fielddoc">
<p>Perform single measurment and go idle </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="aa61bbb41b3a83a67b09bd239677cf96c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Sonar_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="sonar_8h.html#adbd34a926249020be7c9d3174b11c561">SonarWorkModes</a>&#160;</td>
          <td class="paramname"><em>InitialWorkMode</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize Sonar and required peripherials. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">InitialWorkMode</td><td>Set initial sonar work mode </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a1e1a0ad5e1194e9983d26c84c1f2c634"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SonarDistHandler </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>distance_cm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>User handler for sonar measurment results This function handles results from sonar's continuous measurments. It is also called when user triggered single measurment finishes. User can specify here what to do with the results. If sonar is used, user can obtain the angle at which the measurment was taken by reading global variable <a class="el" href="servo_8h.html#a6ca30760f53d2a937b251cfb0e76a6e0" title="Define Servo Position in degrees. This variable contains predicted position of a servo. ">ServoPosition</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">distance_cm</td><td>Measured distance in cm. If measurment failed or was out of range function will be called with parameter 0. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ab806322900d6f7aee955e198bf4893c8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t SonarGetDistance </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize a single sonar measurment and return distance in cm. This function can be used to trigger a single measurment. </p>
<dl class="section warning"><dt>Warning</dt><dd>This function uses busy-waiting to check servo and sonar readiness </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>Measured distance in cm </dd></dl>

</div>
</div>
<a class="anchor" id="abd69db8cc01c44c40690a6b6cc795860"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SonarStartMeas </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize a single sonar measurment This function can be used to trigger a single measurment. Interupt will trigger <a class="el" href="sonar_8c.html#a86eef6da455b037173b71729addbbabc" title="User handler for sonar measurment results This function handles results from sonar&#39;s continuous measu...">SonarDistHandler</a>. </p>
<dl class="section warning"><dt>Warning</dt><dd>This function uses busy-waiting to check servo and sonar readiness </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a39581d0ec8dddb42a2cb1df283d3de42"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="sonar_8h.html#adbd34a926249020be7c9d3174b11c561">SonarWorkModes</a> SonarMode</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Define sonar work mode. </p>
<p>This variable sets sonar work mode. You can set it to different mode during run time </p>

</div>
</div>
<a class="anchor" id="a6faa66e593ade7813b3e52d512b10cf4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="sonar_8h.html#a693dc1e4acb94a17457de163dba95281">SonarFSM</a> SonarState</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Defines current sonar state. </p>
<p>Default sonar work mode is SINGLE </p><dl class="section warning"><dt>Warning</dt><dd>{Do NOT change this anywhere except <a class="el" href="sonar_8c.html#a86eef6da455b037173b71729addbbabc" title="User handler for sonar measurment results This function handles results from sonar&#39;s continuous measu...">SonarDistHandler()</a>. Doing so might result in deadlock.} </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_dfc317270c89deb8038687819d9c4f9f.html">sonar</a></li><li class="navelem"><a class="el" href="sonar_8h.html">sonar.h</a></li>
    <li class="footer">Generated on Mon Dec 22 2014 02:06:40 for Zumo - Sonar lib by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.8 </li>
  </ul>
</div>
</body>
</html>
